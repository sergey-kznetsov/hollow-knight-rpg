<form class="hkrpg sheet actor-sheet" autocomplete="off">
  <header class="sheet-header">
    <div class="hkrpg-row">
      <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}" height="80" width="80" />

      <div style="flex:1; margin-left:10px;">
        <h2 style="margin:0;">
          <input name="name" type="text" value="{{actor.name}}" />
        </h2>

        <div class="hkrpg-actions" style="margin-top:6px;">
          <button type="button" data-action="roll-init">
            <i class="fas fa-bolt"></i> {{localize "HKRPG.Chat.Initiative"}}
          </button>
        </div>
      </div>

      <span class="hkrpg-pill">{{localize "HKRPG.Actor.Types.character"}}</span>
    </div>
  </header>

  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="stats">{{localize "HKRPG.Sheet.Tabs.characteristics"}}</a>
    <a class="item" data-tab="inventory">{{localize "HKRPG.Sheet.Tabs.inventory"}}</a>
    <a class="item" data-tab="combat">{{localize "HKRPG.Sheet.Tabs.combat"}}</a>
    <a class="item" data-tab="biography">{{localize "HKRPG.Sheet.Tabs.biography"}}</a>
  </nav>

  <section class="sheet-body">
    <!-- STATS -->
    <div class="tab" data-group="primary" data-tab="stats">
      <div class="hkrpg-grid hkrpg-cols-2">
        <div class="hkrpg-card">
          <h3>{{localize "HKRPG.Sheet.Tabs.characteristics"}}</h3>

          <div class="hkrpg-row characteristic">
            <label>{{localize "HKRPG.Actor.Characteristics.might"}}</label>
            <input type="number" name="system.characteristics.might.value" value="{{system.characteristics.might.value}}" />
          </div>

          <div class="hkrpg-row characteristic">
            <label>{{localize "HKRPG.Actor.Characteristics.grace"}}</label>
            <input type="number" name="system.characteristics.grace.value" value="{{system.characteristics.grace.value}}" />
          </div>

          <div class="hkrpg-row characteristic">
            <label>{{localize "HKRPG.Actor.Characteristics.shell"}}</label>
            <input type="number" name="system.characteristics.shell.value" value="{{system.characteristics.shell.value}}" />
          </div>

          <div class="hkrpg-row characteristic">
            <label>{{localize "HKRPG.Actor.Characteristics.insight"}}</label>
            <input type="number" name="system.characteristics.insight.value" value="{{system.characteristics.insight.value}}" />
          </div>
        </div>

        <div class="hkrpg-card">
          <h3>{{localize "HKRPG.Actor.Pools.hearts"}} / {{localize "HKRPG.Actor.Pools.soul"}} / {{localize "HKRPG.Actor.Pools.stamina"}}</h3>

          <div class="hkrpg-row">
            <label>{{localize "HKRPG.Actor.Pools.hearts"}}</label>
            <input type="number" name="system.pools.hearts.value" value="{{system.pools.hearts.value}}" />
            <span>/</span>
            <input type="number" name="system.pools.hearts.max" value="{{system.pools.hearts.max}}" />
          </div>

          <div class="hkrpg-row">
            <label>{{localize "HKRPG.Actor.Pools.soul"}}</label>
            <input type="number" name="system.pools.soul.value" value="{{system.pools.soul.value}}" />
            <span>/</span>
            <input type="number" name="system.pools.soul.max" value="{{system.pools.soul.max}}" />
          </div>

          <div class="hkrpg-row">
            <label>{{localize "HKRPG.Actor.Pools.stamina"}}</label>
            <input type="number" name="system.pools.stamina.value" value="{{system.pools.stamina.value}}" />
            <span>/</span>
            <input type="number" name="system.pools.stamina.max" value="{{system.pools.stamina.max}}" />
          </div>

          <div class="hkrpg-row">
            <label>{{localize "HKRPG.Actor.Pools.satiety"}}</label>
            <input type="number" name="system.pools.satiety.value" value="{{system.pools.satiety.value}}" />
            <span>/</span>
            <input type="number" name="system.pools.satiety.max" value="{{system.pools.satiety.max}}" />
          </div>
        </div>

        <div class="hkrpg-card">
          <h3>Вторичные</h3>

          <div class="hkrpg-row">
            <label>{{localize "HKRPG.Actor.Secondary.speed"}}</label>
            <input type="number" name="system.secondary.speed.value" value="{{system.secondary.speed.value}}" />
          </div>

          <div class="hkrpg-row">
            <label>{{localize "HKRPG.Actor.Secondary.load"}}</label>
            <input type="number" name="system.secondary.load.value" value="{{system.secondary.load.value}}" />
            <span>/</span>
            <input type="number" name="system.secondary.load.max" value="{{system.secondary.load.max}}" />
          </div>

          <div class="hkrpg-row">
            <label>{{localize "HKRPG.Actor.Secondary.maneuverability"}}</label>
            <input type="number" name="system.secondary.maneuverability.value" value="{{system.secondary.maneuverability.value}}" />
          </div>

          <div class="hkrpg-row">
            <label>{{localize "HKRPG.Actor.Secondary.beltSize"}}</label>
            <input type="number" name="system.secondary.beltSize.value" value="{{system.secondary.beltSize.value}}" />
          </div>

          <div class="hkrpg-row">
            <label>{{localize "HKRPG.Actor.Secondary.techniqueSlots"}}</label>
            <input type="number" name="system.secondary.techniqueSlots.value" value="{{system.secondary.techniqueSlots.value}}" />
            <span>/</span>
            <input type="number" name="system.secondary.techniqueSlots.max" value="{{system.secondary.techniqueSlots.max}}" />
          </div>

          <div class="hkrpg-row">
            <label>{{localize "HKRPG.Actor.Secondary.marks"}}</label>
            <input type="number" name="system.secondary.marks.value" value="{{system.secondary.marks.value}}" />
            <span>/</span>
            <input type="number" name="system.secondary.marks.max" value="{{system.secondary.marks.max}}" />
          </div>
        </div>

        <div class="hkrpg-card">
          <h3>Состояния / бой</h3>

          <div class="hkrpg-row">
            <label>{{localize "HKRPG.Actor.Combat.imbalance"}}</label>
            <input type="number" name="system.combat.imbalance.value" value="{{system.combat.imbalance.value}}" />
            <span>/</span>
            <input type="number" name="system.combat.imbalance.max" value="{{system.combat.imbalance.max}}" />
          </div>

          <div class="hkrpg-row">
            <label>{{localize "HKRPG.Actor.Combat.delayedDmg"}}</label>
            <input type="number" name="system.combat.delayedDmg.value" value="{{system.combat.delayedDmg.value}}" />
          </div>

          <div class="hkrpg-row">
            <label>{{localize "HKRPG.Actor.Combat.initiative"}}</label>
            <input type="number" name="system.combat.initiative.value" value="{{system.combat.initiative.value}}" />
          </div>

          <div class="hkrpg-row">
            <label>Бонус инициативы (не от оружия)</label>
            <input type="number" name="system.combat.initiativeBonus.value" value="{{system.combat.initiativeBonus.value}}" />
          </div>
        </div>
      </div>
    </div>

    <!-- INVENTORY -->
    <div class="tab" data-group="primary" data-tab="inventory">
      <div class="hkrpg-card">
        <h3>{{localize "HKRPG.Sheet.Sections.equipment"}}</h3>

        <div class="hkrpg-actions" style="margin-bottom:8px;">
          <button type="button" data-action="item-create" data-type="weapon"><i class="fas fa-plus"></i> {{localize "HKRPG.Item.Types.weapon"}}</button>
          <button type="button" data-action="item-create" data-type="armor"><i class="fas fa-plus"></i> {{localize "HKRPG.Item.Types.armor"}}</button>
          <button type="button" data-action="item-create" data-type="charm"><i class="fas fa-plus"></i> {{localize "HKRPG.Item.Types.charm"}}</button>
          <button type="button" data-action="item-create" data-type="consumable"><i class="fas fa-plus"></i> {{localize "HKRPG.Item.Types.consumable"}}</button>
          <button type="button" data-action="item-create" data-type="art"><i class="fas fa-plus"></i> {{localize "HKRPG.Item.Types.art"}}</button>
          <button type="button" data-action="item-create" data-type="spell"><i class="fas fa-plus"></i> {{localize "HKRPG.Item.Types.spell"}}</button>
          <button type="button" data-action="item-create" data-type="trait"><i class="fas fa-plus"></i> {{localize "HKRPG.Item.Types.trait"}}</button>
          <button type="button" data-action="item-create" data-type="path"><i class="fas fa-plus"></i> {{localize "HKRPG.Item.Types.path"}}</button>
        </div>

        <ol class="items-list">
          {{#each items as |item|}}
          <li class="item hkrpg-row" data-item-id="{{item._id}}">
            <div style="display:flex; align-items:center; gap:8px; flex:1;">
              <img src="{{item.img}}" width="24" height="24" />
              <b>{{item.name}}</b>
              <span style="color: var(--hk-muted);">
                ({{localize (concat "HKRPG.Item.Types." item.type)}})
              </span>
              {{#if item.system.equipped}}<span class="hkrpg-pill">экип.</span>{{/if}}
            </div>

            <div class="hkrpg-actions">
              {{#if (or (eq item.type "weapon") (eq item.type "spell") (eq item.type "art"))}}
              <button type="button" class="item-roll" title="{{localize 'HKRPG.UI.Roll'}}">
                <i class="fas fa-dice"></i>
              </button>
              {{/if}}

              {{#if (or (eq item.type "weapon") (eq item.type "armor") (eq item.type "charm"))}}
              <button type="button" class="item-toggle-equipped" title="Экипировать/снять">
                <i class="fas fa-tshirt"></i>
              </button>
              {{/if}}

              <button type="button" class="item-edit" title="{{localize 'HKRPG.UI.Edit'}}">
                <i class="fas fa-edit"></i>
              </button>
              <button type="button" class="item-delete" title="{{localize 'HKRPG.UI.Delete'}}">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </li>
          {{/each}}
        </ol>
      </div>
    </div>

    <!-- COMBAT -->
    <div class="tab" data-group="primary" data-tab="combat">
      <div class="hkrpg-card">
        <h3>Бой</h3>

        <div class="hkrpg-actions">
          <button type="button" data-action="attack"><i class="fas fa-dice"></i> {{localize "HKRPG.Combat.Actions.attack"}}</button>
          <button type="button" data-action="dodge"><i class="fas fa-wind"></i> {{localize "HKRPG.Chat.Dodge"}}</button>
          <button type="button" data-action="parry"><i class="fas fa-shield-alt"></i> {{localize "HKRPG.Chat.Parry"}}</button>
        </div>

        <hr />

        <div class="hkrpg-row">
          <label>Атак за ход (служебное)</label>
          <input type="number" name="system.turn.attacksThisTurn" value="{{system.turn.attacksThisTurn}}" />
        </div>

        <p style="color: var(--hk-muted); margin-top:8px;">
          Атака требует минимум 1 Выносливости и имеет налог на повторные атаки в этот же ход.
        </p>
      </div>
    </div>

    <!-- BIO -->
    <div class="tab" data-group="primary" data-tab="biography">
      <div class="hkrpg-grid hkrpg-cols-2">
        <div class="hkrpg-card">
          <h3>{{localize "HKRPG.Sheet.Sections.notes"}}</h3>
          <textarea name="system.biography.description" rows="14">{{system.biography.description}}</textarea>
        </div>

        <div class="hkrpg-card">
          <h3>Заметки</h3>
          <textarea name="system.biography.notes" rows="14">{{system.biography.notes}}</textarea>
        </div>
      </div>
    </div>
  </section>
</form>
